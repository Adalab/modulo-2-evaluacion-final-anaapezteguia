"use strict";const formElement=document.querySelector(".js-form"),inputElement=document.querySelector(".js-seriesInput"),searchBtnElement=document.querySelector(".js-searchBtn"),resetBtnElement=document.querySelector(".js-resetBtn"),clearBtnElement=document.querySelector(".js-clearBtn"),ulResultsElement=document.querySelector(".js-searchList"),ulFavListElement=document.querySelector(".js-favListContainer");let seriesArray=[],favSeries=[];function getSeries(){const e=inputElement.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{for(const t of e)seriesArray.push(t.show);paintSearchResults()})}function clearSearch(){inputElement.value="",ulResultsElement.innerHTML="",seriesArray=[]}function clearFavorites(){ulFavListElement.innerHTML="",favSeries=[],localStorage.clear()}function handleForm(e){e.preventDefault()}function setInLocalStorage(){const e=JSON.stringify(favSeries);localStorage.setItem("favSeries",e)}function removeFromLocalStorage(){setInLocalStorage();const e=localStorage.getItem("favSeries"),t=JSON.parse(e);localStorage.removeItem(t)}function getFromLocalStorage(){const e=localStorage.getItem("favSeries");if(e){const t=JSON.parse(e);favSeries=t,paintFavoritesList()}}function paintSearchResults(){let e="";for(const t of seriesArray){let s,i,r;s=isFavoriteList(t)?"goToFavorites":"hidden",isFavoriteSerie(t)?(i="favorite",r="â­‘"):(i="",r="");const n=t.id,a=t.name,l=t.image;e+=`<li class="searchList__li js-series" id="${n}">`,e+='<div class="searchList__container">',e+=`<img class="${i} favImg js-seriesImg" src="${null===l?"https://via.placeholder.com/210x295/dcbcc6/666666/?text=DEFAULT IMAGE":l.medium}" alt="${a}" title="${a}" height="295px" width="210px" >`,e+=`<h3 class="searchList__title ${i} title js-seriesTitle">${a} ${r}`,e+="</div>",e+="</li>"}ulResultsElement.innerHTML=e,listenSeriesEvents()}function paintFavoritesList(){let e="";for(const t of favSeries){let s;s=isFavoriteList(t)?"goToFavorites":"";const i=t.id,r=t.name,n=t.image;e+=`<li class="favList__li js-favList" id="${i}">`,e+='<div class="favList__results">',e+=`<img class="${s} favImg js-seriesImg" src="${null===n?"https://via.placeholder.com/105x148/dcbcc6/666666/?text=DEFAULT IMAGE":n.medium}" alt="${r}" title="${r}" height="148px" width="105px" >`,e+=`<h3 class="favList__title ${s} title js-seriesTitle">${r}`,e+="</div>",e+="</li>"}ulFavListElement.innerHTML=e,listenFavoritesEvent()}function isFavoriteSerie(e){return void 0!==favSeries.find(t=>t.id===e.id)}function isFavoriteList(e){const t=inputElement.value;return e.name.includes(t)}function listenSeriesEvents(){const e=document.querySelectorAll(".js-series");for(const t of e)t.addEventListener("click",handlePickedSeries)}function listenFavoritesEvent(){const e=document.querySelectorAll(".js-favList");for(const t of e)t.addEventListener("click",handlePickedSeries)}function handlePickedSeries(e){const t=parseInt(e.currentTarget.id),s=favSeries.findIndex((function(e){return e.id===t}));if(-1===s){const e=seriesArray.find((function(e){return e.id===t}));favSeries.push(e),setInLocalStorage()}else favSeries.splice(s,1),removeFromLocalStorage();paintSearchResults(),paintFavoritesList()}searchBtnElement.addEventListener("click",getSeries),inputElement.addEventListener("focus",clearSearch),resetBtnElement.addEventListener("click",clearSearch),clearBtnElement.addEventListener("click",clearFavorites),formElement.addEventListener("submit",handleForm),getFromLocalStorage();